@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  @font-face {
    font-family: "Geist";
    src: url("/fonts/geist-variable.woff2") format("woff2");
    font-display: swap;
  }
  @font-face {
    font-family: "Geist Mono";
    src: url("/fonts/geist-mono-variable.woff2") format("woff2");
    font-display: swap;
  }

  html.dark .astro-code,
  html.dark .astro-code span {
    color: var(--shiki-dark) !important;
    background-color: var(--shiki-dark-bg) !important;
    font-style: var(--shiki-dark-font-style) !important;
    font-weight: var(--shiki-dark-font-weight) !important;
    text-decoration: var(--shiki-dark-text-decoration) !important;
  }

  :root {
    --background: 60 9% 98%;
    --foreground: 0 0% 8%;
    --card: 60 6% 97%;
    --card-foreground: 0 0% 8%;
    --popover: 60 9% 98%;
    --popover-foreground: 0 0% 8%;
    --primary: 0 0% 5%;
    --primary-foreground: 60 9% 98%;
    --secondary: 60 5% 94%;
    --secondary-foreground: 0 0% 12%;
    --muted: 60 5% 94%;
    --muted-foreground: 0 0% 40%;
    --accent: 45 100% 51%;
    --accent-foreground: 0 0% 5%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 88%;
    --input: 0 0% 88%;
    --ring: 0 0% 20%;
    --radius: 0px;
  }

  .dark {
    --background: 0 0% 6%;
    --foreground: 60 5% 90%;
    --card: 0 0% 8%;
    --card-foreground: 60 5% 90%;
    --popover: 0 0% 6%;
    --popover-foreground: 60 5% 90%;
    --primary: 60 5% 90%;
    --primary-foreground: 0 0% 6%;
    --secondary: 0 0% 12%;
    --secondary-foreground: 60 5% 90%;
    --muted: 0 0% 14%;
    --muted-foreground: 0 0% 55%;
    --accent: 45 100% 51%;
    --accent-foreground: 0 0% 5%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 18%;
    --input: 0 0% 18%;
    --ring: 0 0% 70%;
  }
}

/* Custom animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes pulse-subtle {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.animate-fade-in-up {
  animation: fadeInUp 0.5s ease-out forwards;
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out forwards;
}

.animate-slide-in {
  animation: slideIn 0.4s ease-out forwards;
}

/* Staggered animation delays */
.stagger-1 { animation-delay: 0.05s; }
.stagger-2 { animation-delay: 0.1s; }
.stagger-3 { animation-delay: 0.15s; }
.stagger-4 { animation-delay: 0.2s; }
.stagger-5 { animation-delay: 0.25s; }
.stagger-6 { animation-delay: 0.3s; }

@layer components {
  article {
    @apply font-serif;

    p {
      @apply my-6 text-[16.5px] font-medium leading-[1.9] tracking-normal text-zinc-700 dark:text-zinc-300;
    }
    h1 {
      @apply mt-14 mb-5 font-sans text-2xl font-semibold tracking-tight text-zinc-900 dark:text-white;
    }
    h2 {
      @apply mt-12 mb-4 font-sans text-xl font-semibold tracking-tight text-zinc-900 dark:text-white;
    }
    h3 {
      @apply mt-10 mb-3 font-sans text-lg font-semibold tracking-normal text-zinc-900 dark:text-white;
    }
    h4, h5, h6 {
      @apply mt-8 mb-3 font-sans font-semibold tracking-normal text-zinc-900 dark:text-white;
    }
    :not(pre) > code {
      @apply whitespace-nowrap rounded-none border-0 bg-amber-100/60 px-1.5 py-0.5 font-mono text-[0.875em] font-medium text-amber-900 dark:bg-amber-500/20 dark:text-amber-200;
    }
    pre:has(code) {
      @apply my-6 max-h-[600px] overflow-auto border border-zinc-200/80 p-5 font-mono text-sm font-normal dark:border-zinc-800 dark:bg-zinc-900/50;
    }
    img {
      @apply my-6 border border-zinc-200/80 dark:border-zinc-800;
    }
    video {
      @apply my-6 border border-zinc-200/80 dark:border-zinc-800;
    }
    blockquote {
      @apply my-8 border-l-2 border-zinc-300 pl-6 text-[16px] font-medium leading-[1.85] text-zinc-500 dark:border-zinc-600 dark:text-zinc-400;
    }
    a {
      @apply text-zinc-900 underline decoration-zinc-400 decoration-1 underline-offset-2 transition-colors hover:decoration-zinc-900 dark:text-zinc-100 dark:decoration-zinc-600 dark:hover:decoration-zinc-100;
    }
    table {
      @apply my-6 w-full table-auto border-collapse text-sm;
      th {
        @apply border-b border-zinc-300 p-4 text-left font-semibold dark:border-zinc-700;
      }
      td {
        @apply border-b border-zinc-200 p-4 dark:border-zinc-800;
      }
    }
    ol {
      @apply my-5 list-inside list-decimal space-y-3 text-[16.5px] font-medium leading-[1.85] text-zinc-700 dark:text-zinc-300 [&_ol]:pl-6 [&_ul]:pl-6;
    }
    ul {
      @apply my-5 list-inside list-disc space-y-3 text-[16.5px] font-medium leading-[1.85] text-zinc-700 dark:text-zinc-300 [&_ol]:pl-6 [&_ul]:pl-6;
    }
    kbd {
      @apply border border-zinc-300 bg-zinc-100 px-1.5 py-0.5 font-mono text-xs font-medium text-zinc-800 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-200;
    }
    mark {
      @apply bg-amber-200/60 px-0.5 text-inherit dark:bg-amber-500/30;
    }
    hr {
      @apply my-10 border-t border-zinc-200 dark:border-zinc-800;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    background-image:
      url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(0 0 0 / 0.04)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
    background-repeat: repeat;
    background-position: center;
  }

  .dark body {
    background-image:
      url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(255 255 255 / 0.03)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
  }

  /* Code line numbers */
  code {
    counter-reset: step;
    counter-increment: step 0;
  }
  code .line::before {
    content: counter(step);
    counter-increment: step;
    width: 1.5rem;
    margin-right: 1.5rem;
    display: inline-block;
    text-align: right;
    color: hsl(0 0% 45%);
  }

  /* Selection */
  ::selection {
    @apply bg-amber-200/70 text-zinc-900;
  }

  .dark ::selection {
    @apply bg-amber-500/30 text-zinc-100;
  }

  /* Smooth scroll */
  html {
    scroll-behavior: smooth;
  }

  /* Focus styles */
  :focus-visible {
    @apply outline-none ring-2 ring-zinc-900 ring-offset-2 ring-offset-background dark:ring-zinc-100;
  }
}

/* Link hover effect */
.link-hover {
  @apply relative;
}

.link-hover::after {
  content: '';
  @apply absolute bottom-0 left-0 h-px w-0 bg-current transition-all duration-300;
}

.link-hover:hover::after {
  @apply w-full;
}

/* Grain texture overlay */
.grain::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: 0.015;
  z-index: 1000;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
}

.dark .grain::before {
  opacity: 0.03;
}
